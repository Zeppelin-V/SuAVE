PivotViewer.Views.TileBasedView=PivotViewer.Views.IPivotViewerView.subClass({init:function(){this._super();var t=this;$.subscribe("/PivotViewer/Views/Canvas/Drag",function(e){if(t.isActive){var i=e.x,s=e.y;i>0&&t.currentOffsetX>t.offsetX?i=0:t.currentOffsetX<t.offsetX&&t.currentWidth==t.width?i=0:0>i&&t.currentOffsetX<-t.currentWidth+t.width?i=0:t.currentOffsetX+=i,s>0&&t.currentOffsetY+t.canvasHeightUIAdjusted>t.currentHeight+t.offsetY?s=0:t.currentOffsetY<t.offsetY&&t.currentHeight==t.height?s=0:0>s&&t.currentOffsetY-t.offsetY<-t.currentHeight+t.height?s=0:t.currentOffsetY+=s,(0!=i||0!=s)&&t.offsetTiles(i,s)}})},super_handleClick:function(t){if("init"==t.type)for(var e=0;e<this.filterList.length;e++){var i=this.filterList[e].item.id;if(i==t.id)return this.filterList[e]}else for(var e=0;e<this.filterList.length;e++){var i=this.filterList[e].contains(t.x,t.y);if(i>=0)return this.filterList[e]}},handleClick:function(t){return this.super_handleClick(t)},super_handleHover:function(t){if(null==this.selected)for(var e=0;e<this.filterList.length;e++){var i=this.filterList[e].contains(t.x,t.y);i>=0?this.filterList[e].setSelected(!0):this.filterList[e].setSelected(!1)}},handleHover:function(t){this.super_handleHover(t)},activate:function(){this._super(),$(".pv-toolbarpanel-zoomslider").fadeIn(),$(".pv-toolbarpanel-zoomcontrols").css("border-width","1px"),$("#MAIN_BODY").css("overflow","auto"),$(".pv-toolbarpanel-sort").fadeIn(),$(".pv-canvas").fadeIn()},deactivate:function(){this._super(),$(".pv-toolbarpanel-zoomslider").fadeOut(),$(".pv-toolbarpanel-sort").fadeOut(),$(".pv-canvas").fadeOut()},offsetTiles:function(t,e){for(var i=0;i<this.filterList.length;i++)this.filterList[i]._locations[0].destinationx+=t,this.filterList[i]._locations[0].destinationy+=e},calculateDimensions:function(t,e,i,s){var r=.9,n=i*(s-r*r),o=(e+t*i)*r,f=-1*(e*t),a=(-1*o+Math.sqrt(o*o-4*n*f))/(2*n),l=Math.floor(a*i),h=Math.floor(e/l),u=t>a?Math.floor(t/a):1,c=t-u*a,d=e-h*l;return 3>l&&(l=3),{Rows:h,Columns:u,TileMaxWidth:a,TileHeight:l,PaddingX:c,PaddingY:d}},getTileDimensions:function(t,e,i,s,r){var n=.9,o=i*(s-n*n),f=(e+t*i)*n,a=-1*(e*t),l=(-1*f+Math.sqrt(f*f-4*o*a))/(2*o),h=Math.floor(l*i),u=t-r.Columns*l,c=e-r.Rows*h;return{Rows:r.Rows,Columns:r.Columns,TileMaxWidth:l,TileHeight:h,PaddingX:u,PaddingY:c}}});
